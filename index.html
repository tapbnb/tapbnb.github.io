<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Auto Predictor — FROZEN sau 08:00 (GMT+7)</title>
<meta name="description" content="Tự động cron: 00–08h phân tích → FROZEN sau 08:00; 08–24h cập nhật kết quả. XSMB Best Lô + 2 xiên, Mega/Power/Max3D theo ngày quay, Lotto 5/35 (SB 01–12).">
<style>
  :root{--bg:#0b1210;--card:#101a16;--text:#f6fbff;--muted:#a8c3b6;--acc:#00e6a8;--gold:#ffd95e;--red:#ff7f7f;--border:#163328;--pill:#0b1a15}
  *{box-sizing:border-box} body{margin:0;font-family:-apple-system,BlinkMacSystemFont,system-ui,Segoe UI,Roboto;color:var(--text);background:linear-gradient(180deg,#07110d,#0b1210 55%,#0b1210)}
  .wrap{max-width:1200px;margin:36px auto;padding:0 16px}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:18px 16px;box-shadow:0 10px 30px rgba(0,0,0,.35);margin-bottom:16px}
  h1{margin:0 0 6px;font-size:26px} h2{margin:8px 0 4px;font-size:20px}
  .muted{color:var(--muted);font-size:14px} .small{font-size:12px;opacity:.9}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .btn{cursor:pointer;border:1px solid #2a6b57;background:#0f2a22;color:#eafff7;border-radius:10px;padding:8px 12px}
  .btn:hover{filter:brightness(1.07)}
  .pill{display:inline-block;margin:6px 6px 0 0;padding:7px 12px;border-radius:999px;border:1px solid #1f5646;background:var(--pill)}
  .box{background:#0d1814;border:1px dashed #1a3e33;border-radius:10px;padding:10px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
  table{width:100%;border-collapse:collapse} th,td{border:1px solid #1e3e33;padding:6px 8px;font-size:14px} th{background:#0d1814}
  .tag{border:1px solid #335d50;background:#10241e;padding:6px 10px;border-radius:8px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>🧠 Auto Predictor — FROZEN sau 08:00 (GMT+7)</h1>
    <div class="muted">Cron tự động: <b>00:00–08:00</b> phân tích đầy đủ ⇒ <b>đóng băng dự đoán</b> ~08:00. <b>08:00–24:00</b> chỉ cập nhật <i>kết quả</i>. Không cần can thiệp.</div>
    <div class="row" style="margin-top:8px">
      <button class="btn" id="refresh">↻ Nạp dữ liệu</button>
      <span class="tag">Cập nhật JSON: <span id="updated">—</span></span>
      <span class="tag">Chế độ: <span id="mode">—</span></span>
      <span class="muted" id="status">Đang khởi động…</span>
    </div>
  </div>

  <div class="card">
    <h2>📊 XSMB — Dự đoán (FROZEN) & Kết quả</h2>
    <div class="row">
      <div class="box"><b>Best lô (ngày):</b> <span id="best-lo" class="pill">—</span> <span class="small">conf=<span id="best-lo-conf">—</span></span></div>
      <div class="box"><b>Xiên 2 (2 cặp):</b> <span id="x1" class="pill">—</span> <span id="x2" class="pill">—</span></div>
      <div class="box"><b>Dự đoán ngày:</b> <span id="pred-date" class="small">—</span></div>
    </div>
    <details style="margin-top:10px">
      <summary>Top10 lô & ghi chú mô hình</summary>
      <div id="xsmb-top"></div>
      <div class="small" id="xsmb-notes" style="margin-top:8px;color:#ffd95e"></div>
    </details>
    <div class="box" style="margin-top:10px">
      <b>Kết quả XSMB hôm nay:</b> <span id="xsmb-out" class="pill">—</span> <span class="small">(nguồn: <span id="xsmb-src">—</span>)</span>
    </div>
  </div>

  <div class="card">
    <h2>🔮 Vietlott — Dự đoán (FROZEN theo ngày quay) & Kết quả</h2>
    <div class="grid">
      <div class="box">
        <b>Mega 6/45</b> <div class="small">Ngày quay: <span id="mega-date">—</span></div>
        <table style="margin-top:6px"><thead><tr><th>Dự đoán</th><th>5 bộ</th></tr></thead><tbody id="mega-picks"></tbody></table>
        <div class="small" style="margin-top:6px"><b>KQ gần nhất:</b> <span id="mega-out">—</span> <span>(nguồn: <span id="mega-src">—</span>)</span></div>
      </div>
      <div class="box">
        <b>Power 6/55</b> <div class="small">Ngày quay: <span id="power-date">—</span></div>
        <table style="margin-top:6px"><thead><tr><th>Dự đoán</th><th>5 bộ</th></tr></thead><tbody id="power-picks"></tbody></table>
        <div class="small" style="margin-top:6px"><b>KQ gần nhất:</b> <span id="power-out">—</span> <span>(nguồn: <span id="power-src">—</span>)</span></div>
      </div>
      <div class="box">
        <b>Max 3D</b> <div class="small">Ngày quay: <span id="max3d-date">—</span></div>
        <table style="margin-top:6px"><thead><tr><th>Dự đoán</th><th>5 gợi ý</th></tr></thead><tbody id="max3d-picks"></tbody></table>
        <div class="small" style="margin-top:6px"><b>KQ gần nhất:</b> <span id="max3d-out">—</span> <span>(nguồn: <span id="max3d-src">—</span>)</span></div>
      </div>
      <div class="box">
        <b>Lotto 5/35</b> <div class="small">Kỳ 13:00 & 21:00 — có SB 01–12</div>
        <table style="margin-top:6px"><thead><tr><th>Kỳ</th><th>5 bộ (5 số + SB)</th></tr></thead><tbody id="l535-picks"></tbody></table>
        <div class="small" style="margin-top:6px">
          <b>KQ 13:00:</b> <span id="l535-13">—</span> &nbsp; <b>21:00:</b> <span id="l535-21">—</span>
          <span>(nguồn: <span id="l535-src">—</span>)</span>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
async function loadJSON(){
  const url='data/predictions.json?v='+Date.now();
  const r=await fetch(url,{cache:'no-store'});
  return r.ok? r.json(): {mode:'—', updated_at:'—'};
}
function pill(s){return '<span class="pill">'+s+'</span>';}
function render(d){
  document.getElementById('updated').textContent = d.updated_at||'—';
  document.getElementById('mode').textContent = d.mode||'—';
  const p=d.predictions||{};
  document.getElementById('pred-date').textContent = p.date||'—';
  const px=p.xsmb||{};
  document.getElementById('best-lo').textContent = px.best||'—';
  document.getElementById('best-lo-conf').textContent = (px.conf??'—');
  const x=px.xien||[['—','—'],['—','—']];
  document.getElementById('x1').textContent = x[0].join(' - ');
  document.getElementById('x2').textContent = x[1].join(' - ');
  document.getElementById('xsmb-top').innerHTML = (px.top10||[]).map(pill).join(' ');
  document.getElementById('xsmb-notes').textContent = px.notes||'';
  document.getElementById('mega-date').textContent = (p.mega?.date)||'—';
  document.getElementById('mega-picks').innerHTML = (p.mega?.sets||[]).map(s=>'<tr><td>Frozen</td><td>'+pill(s.join(' '))+'</td></tr>').join('');
  document.getElementById('power-date').textContent = (p.power?.date)||'—';
  document.getElementById('power-picks').innerHTML = (p.power?.sets||[]).map(s=>'<tr><td>Frozen</td><td>'+pill(s.join(' '))+'</td></tr>').join('');
  document.getElementById('max3d-date').textContent = (p.max3d?.date)||'—';
  document.getElementById('max3d-picks').innerHTML = (p.max3d?.sets||[]).map(s=>'<tr><td>Frozen</td><td>'+pill(s)+'</td></tr>').join('');
  document.getElementById('l535-picks').innerHTML =
    (p.l535?.sets13?.length? '<tr><td>13:00</td><td>'+ (p.l535.sets13||[]).map(arr=>pill(arr.slice(0,5).join(' ')+' • SB '+arr[5])).join(' ') +'</td></tr>' : '') +
    (p.l535?.sets21?.length? '<tr><td>21:00</td><td>'+ (p.l535.sets21||[]).map(arr=>pill(arr.slice(0,5).join(' ')+' • SB '+arr[5])).join(' ') +'</td></tr>' : '');
  const o=d.outcomes||{};
  document.getElementById('xsmb-out').textContent = (o.xsmb?.twos||[]).join(' ')||'—';
  document.getElementById('xsmb-src').textContent = o.xsmb?.source||'—';
  document.getElementById('mega-out').textContent = (o.mega?.nums||[]).join(' ')||'—';
  document.getElementById('mega-src').textContent = o.mega?.source||'—';
  document.getElementById('power-out').textContent = (o.power?.nums||[]).join(' ')||'—';
  document.getElementById('power-src').textContent = o.power?.source||'—';
  document.getElementById('max3d-out').textContent = (o.max3d?.latest||[]).join(' ')||'—';
  document.getElementById('max3d-src').textContent = o.max3d?.source||'—';
  document.getElementById('l535-13').textContent = (o.l535?.k13||'—');
  document.getElementById('l535-21').textContent = (o.l535?.k21||'—');
  document.getElementById('l535-src').textContent = o.l535?.source||'—';
  document.getElementById('status').textContent = 'OK';
}
document.getElementById('refresh').onclick = async ()=>{ document.getElementById('status').textContent='Đang nạp…'; const d=await loadJSON(); render(d); };
(async ()=>{ const d=await loadJSON(); render(d); })();
</script>
</body>
</html>
